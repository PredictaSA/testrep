{"name":"Demographics.xlsx_flow","description":"","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","nodes":[{"id":"source1","app_data":{"sampling":{"type":"topRows","size":10000}},"data_asset":{"properties":{"range":"A1:M10750","first_line_header":"true","sheet_name":"Sheet1","file_format":"excel"},"ref":"data_asset.Demographicsxlsx","app_data":{"dataset_name":"Demographics.xlsx"}},"type":"binding","output":{"id":"source1output"}},{"id":"6ad685ce-307a-4e39-9c76-255bf611eb2a","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`CUST_ID` = as.integer(`CUST_ID`),`DATE_OF_BIRTH` = as.Date(lubridate::parse_date_time(`DATE_OF_BIRTH`, \"ymd\", quiet=TRUE)),`FIRST_CUSTOMER_OPENING_DATE` = as.Date(lubridate::parse_date_time(`FIRST_CUSTOMER_OPENING_DATE`, \"ymd\", quiet=TRUE)),`FIRST_E_PRODUCT_OPENING_DATE` = as.Date(lubridate::parse_date_time(`FIRST_E_PRODUCT_OPENING_DATE`, \"ymd\", quiet=TRUE)),`FIRST_DEDIT_CARD_OPENING_DATE` = as.Date(lubridate::parse_date_time(`FIRST_DEDIT_CARD_OPENING_DATE`, \"ymd\", quiet=TRUE)),`FIRST_CREDIT_CARD_OPENING_DATE` = as.Date(lubridate::parse_date_time(`FIRST_CREDIT_CARD_OPENING_DATE`, \"ymd\", quiet=TRUE)),`FIRST_CARD_OPENING_DATE` = as.Date(lubridate::parse_date_time(`FIRST_CARD_OPENING_DATE`, \"ymd\", quiet=TRUE)))","args":{"type":"mutate","conditions":[],"auto":true,"autoConditions":[{"column":"CUST_ID","type":"as.integer","newColumnName":"","format":"","actualType":"double","removeColumn":false,"decimalMarker":".","groupingMarker":""},{"column":"DATE_OF_BIRTH","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"FIRST_CUSTOMER_OPENING_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"FIRST_E_PRODUCT_OPENING_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"FIRST_DEDIT_CARD_OPENING_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"FIRST_CREDIT_CARD_OPENING_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"FIRST_CARD_OPENING_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false}],"autoDecimalSymbol":".","autoGroupingSymbol":"","version":10}}},"parameters":{"FREEFORM_CODE":"mutate(`CUST_ID` = as.integer(`CUST_ID`),`DATE_OF_BIRTH` = stringToDateYMD(`DATE_OF_BIRTH`),`FIRST_CUSTOMER_OPENING_DATE` = stringToDateYMD(`FIRST_CUSTOMER_OPENING_DATE`),`FIRST_E_PRODUCT_OPENING_DATE` = stringToDateYMD(`FIRST_E_PRODUCT_OPENING_DATE`),`FIRST_DEDIT_CARD_OPENING_DATE` = stringToDateYMD(`FIRST_DEDIT_CARD_OPENING_DATE`),`FIRST_CREDIT_CARD_OPENING_DATE` = stringToDateYMD(`FIRST_CREDIT_CARD_OPENING_DATE`),`FIRST_CARD_OPENING_DATE` = stringToDateYMD(`FIRST_CARD_OPENING_DATE`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"58207324-a269-4177-94c7-643502d7b15e","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"extractDateTime","code":"mutate(`YEAR` = lubridate::year(`FIRST_CUSTOMER_OPENING_DATE`))","args":{"column":"FIRST_CUSTOMER_OPENING_DATE","type":"year","actualType":"Date","newColumnName":"YEAR","newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`YEAR` = year(`FIRST_CUSTOMER_OPENING_DATE`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"6ad685ce-307a-4e39-9c76-255bf611eb2a","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"id":"9f9abeec-9f31-4ddf-823f-4ee27eac185b","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"replaceSubstringOp","code":"mutate(`GENDER_NEW` = stringr::str_replace_all(`GENDER`, stringr::fixed(\"n/a\"), \"N/A\"))","args":{"column":"GENDER","replaceOption":"text","in_value":"n/a","out_value":"N/A","replaceAllFlag":true,"newColumnName":"GENDER_NEW","newColumnLocation":"none","version":4}}},"parameters":{"FREEFORM_CODE":"mutate(`GENDER_NEW` = stringReplace(`GENDER`, \"n/a\", \"N/A\", FALSE))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"58207324-a269-4177-94c7-643502d7b15e","port_id_ref":"outputPort2"}]}],"outputs":[{"id":"outputPort3"}]},{"id":"3ee278d5-3bfd-4fd4-a170-65afff6a6d09","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"rename","code":"eval({if(!\"EDUCATION\" %in% names(.)) stop(\"'EDUCATION' not found.\", call. = FALSE) else .})%>%rename(`EDUCATION_LEVEL` = `EDUCATION`)","args":{"column":"EDUCATION","newColumnName":"EDUCATION_LEVEL"}}},"parameters":{"FREEFORM_CODE":"rename(`EDUCATION_LEVEL` = `EDUCATION`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"9f9abeec-9f31-4ddf-823f-4ee27eac185b","port_id_ref":"outputPort3"}]}],"outputs":[{"id":"outputPort4"}]},{"data_asset":{"properties":{"name":"Demographics_xlsx_shaped","file_format":"csv","mode":"overwrite","first_line_header":true},"app_data":{}},"id":"target1","type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"3ee278d5-3bfd-4fd4-a170-65afff6a6d09","port_id_ref":"outputPort4"}}}],"runtime":"Spark"}]}}